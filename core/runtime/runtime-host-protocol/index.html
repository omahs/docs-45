<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-core/runtime/runtime-host-protocol">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Runtime Host Protocol | Oasis Network Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.oasis.io/core/runtime/runtime-host-protocol"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Runtime Host Protocol | Oasis Network Documentation"><meta data-rh="true" name="description" content="The Runtime Host Protocol (RHP) is a simple RPC protocol which is used to"><meta data-rh="true" property="og:description" content="The Runtime Host Protocol (RHP) is a simple RPC protocol which is used to"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.oasis.io/core/runtime/runtime-host-protocol"><link data-rh="true" rel="alternate" href="https://docs.oasis.io/core/runtime/runtime-host-protocol" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.oasis.io/core/runtime/runtime-host-protocol" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.03bfe953.css">
<link rel="preload" href="/assets/js/runtime~main.df39c847.js" as="script">
<link rel="preload" href="/assets/js/main.4ff8f277.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OPF Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="OPF Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Oasis Docs</b></a><a class="navbar__item navbar__link" href="/general/">Use Oasis</a><a class="navbar__item navbar__link" href="/get-involved/">Get Involved</a><a class="navbar__item navbar__link" href="/node/">Run Node</a><a class="navbar__item navbar__link" href="/dapp/">Create dApp</a><a class="navbar__item navbar__link" href="/paratime/">Build ParaTime</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/core/">Develop Core</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oasisprotocol" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub repository" aria-label="GitHub repository"></a><a href="https://oasisprotocol.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-www-link" title="Oasis Protocol Foundation website" aria-label="Oasis Protocol Foundation website"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/core/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/core/development-setup">Development Setup</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/core/development-setup/build-environment-setup-and-building">Build Environment Setup and Building</a><button aria-label="Toggle the collapsible sidebar category &#x27;Build Environment Setup and Building&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/core/development-setup/running-tests-and-development-networks">Running Tests and Development Networks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Running Tests and Development Networks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/core/high-level-components">High-Level Components</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/core/consensus/">Consensus Layer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Consensus Layer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/core/runtime/">Runtime Layer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Runtime Layer&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/core/runtime/runtime-host-protocol">Runtime Host Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/core/runtime/identifiers">Runtime IDs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/core/runtime/messages">Runtime Messages</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/core/oasis-node">Oasis Node</a><button aria-label="Toggle the collapsible sidebar category &#x27;Oasis Node&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/core/common-functionality">Common Functionality</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/encoding">Encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/crypto">Cryptography</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/core/authenticated-grpc">Protocols</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/mkvs">Merklized Key-Value Store (MKVS)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/core/processes">Processes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/release-process">Release Process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/versioning">Versioning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/SECURITY">Security</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/oasis-core-ledger">Oasis Core Ledger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/adrs">ADRs</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Runtime Host Protocol</h1><p>The Runtime Host Protocol (RHP) is a simple RPC protocol which is used to
communicate between a runtime and an Oasis Core Compute Node.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transport">Transport<a class="hash-link" href="#transport" title="Direct link to heading">​</a></h2><p>The RHP assumes a reliable byte stream oriented transport underneath. The only
current implementation uses AF_LOCAL sockets and <a href="https://edp.fortanix.com/docs/api/fortanix_sgx_abi/struct.Usercalls.html#streams" target="_blank" rel="noopener noreferrer">Fortanix ABI streams</a> backed
by shared memory to communicate with runtimes inside Intel SGX enclaves.</p><p><img loading="lazy" alt="Runtime Execution" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSIzODFweCIgaGVpZ2h0PSIxNjFweCIgdmlld0JveD0iLTAuNSAtMC41IDM4MSAxNjEiIGNvbnRlbnQ9IiZsdDtteGZpbGUgaG9zdD0mcXVvdDthcHAuZGlhZ3JhbXMubmV0JnF1b3Q7IG1vZGlmaWVkPSZxdW90OzIwMjAtMDctMjBUMjI6MDM6NTIuNjAzWiZxdW90OyBhZ2VudD0mcXVvdDs1LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTRfNikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg0LjAuNDE0Ny44OSBTYWZhcmkvNTM3LjM2JnF1b3Q7IGV0YWc9JnF1b3Q7anZjbC1DYkd2THY0c3JRQmhkRjcmcXVvdDsgdmVyc2lvbj0mcXVvdDsxMy40LjkmcXVvdDsgdHlwZT0mcXVvdDtkZXZpY2UmcXVvdDsmZ3Q7Jmx0O2RpYWdyYW0gaWQ9JnF1b3Q7REpYWk9tNWJmMmRqOFNFSVE4Sl8mcXVvdDsgbmFtZT0mcXVvdDtQYWdlLTEmcXVvdDsmZ3Q7N1pmTGNwc3dGSWFmeGpQdEloMHU1dEpsZkVuU1R0cVoxcDFwMHAyTURxQkVTSzRRQWZmcEs5bkNnQ0ZPTWdsZGRXTnpmdDIvLzNCc1RkeDVWbDBLdEVtL2NBeDA0bGk0bXJpTGllUFlkdWlyTDYxczkwb1F1SHNoRVFTYlRvMndJbi9BaUpaUkM0SWg3M1NVbkZOSk5sMHg0b3hCSkRzYUVvS1gzVzR4cDkxVk55aUJuckNLRU8yclB3bVc2VjROUGF2UnI0QWthYjJ5YlptV0ROV2RqWkNuQ1BPeUpibkxpVHNYbk12OVUxYk5nV3A0TlpmOXVJdEhXZzhiRThEa2N3YUVpK25zbnBibDR0ZnRqODkwL3UyT2lPVE16UEtBYUdFTy9GVlpPSEY4cXVhY3JZWGV0OXdhR1A3dlFtOTJGbk1tei9LZFZlZXFnKzFzcXFaUlBTWDYrOTMzZ2ttU3FibXNLNTdMOXdiQ1lUSkg4SUpoMEp1elZmY3lKUkpXR3hUcDFsTGxrdEpTbVZIVHJKYzB5V0U3T2lhVXpqbmxZamVYRzhleEUwVkt6NlhnOTlCcXdmN2E5L3pkdm81eDFXY0hJYUZxU1FiZkpmQU1wTmlxTHFiVk5VNmFWTFlkYngrWFRXTFl0ZHRwS3lsOG95R1RpOGxoNXNZdTlXQWNlNEY3VHMrOUU1U3QxMU1PSXhpbXZBNjlxYWNYd0NoUEQ1NitBWExINmpLdlViYVFIMHBGRzdrOUhZdTUyMk8rUWd5dmVkVkRyNDRvdTN5NzNCaG5jQVRaU0lpU2hLa3dVdUJBNlRNTmpLaWlkRzRhTW9LeFhtYlEwSzdsSFVkNkJ1dlk3SGlnb0x6YXJ1a3o3WExHY212YWM2c3BTOWNjWVVWMzFEZm1uOVNsQTlMNk43WlAzZjQ0UU4wZGk3bzNjbDNxNW5RWE9kallnMkFJK1VjL2NORkl5QTkxL3lubXdWak0vUjd6VDZwNDZHR3J5eHYxdVdRUlJRL3d2MG9ObUdjOTA3elJ5bFJ3b2t6TkNFTm1pYkhLRkVZUXhvTmx5bzlDV01kdjlNNDRSOWpkQWV6QkFIWnZMT3hoanlwZzllL2ZoRnpJbENlY0licHMxS084YmZwY2M3NHh0TzlBeXEzQmpRckp1MTVBUmVSTjYvbFdUL1hCTTlHaU1qUHZnbTBkTUhYY20zYlFHcVhEWnRndXFzY2QrNTVMSk9TNXZoYnA5NWFpUENkUkxWOFFXbS94VWJOelhvZ0lUaEN0cjJoSUpDQ2ZUbmlOKzJUcUNLQklrb2Z1WmV3RmVhREM1b2ExYTJ2ZFU5M2xYdz09Jmx0Oy9kaWFncmFtJmd0OyZsdDsvbXhmaWxlJmd0OyI+PGRlZnMvPjxnPjxyZWN0IHg9IjAiIHk9Ijg1IiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjYwIiByeD0iOSIgcnk9IjkiIGZpbGw9IiNmZmYyY2MiIHN0cm9rZT0iI2Q2YjY1NiIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjUgLTAuNSkiPjxzd2l0Y2g+PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OiB2aXNpYmxlOyB0ZXh0LWFsaWduOiBsZWZ0OyIgcG9pbnRlci1ldmVudHM9Im5vbmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiB1bnNhZmUgY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IHVuc2FmZSBjZW50ZXI7IHdpZHRoOiAxMThweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiAxMTVweDsgbWFyZ2luLWxlZnQ6IDFweDsiPjxkaXYgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMDsgdGV4dC1hbGlnbjogY2VudGVyOyAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogIzAwMDAwMDsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgd29yZC13cmFwOiBub3JtYWw7ICI+Tm9kZTxiciBzdHlsZT0iZm9udC1zaXplOiAxMnB4IiAvPihSdW50aW1lIEhvc3QpPC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjYwIiB5PSIxMTkiIGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiIGZvbnQtc2l6ZT0iMTJweCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+Tm9kZS4uLjwvdGV4dD48L3N3aXRjaD48L2c+PHJlY3QgeD0iMTcwIiB5PSIyMCIgd2lkdGg9IjIxMCIgaGVpZ2h0PSIxNDAiIGZpbGw9IiNmOGNlY2MiIHN0cm9rZT0iI2I4NTQ1MCIgc3Ryb2tlLWRhc2hhcnJheT0iMyAzIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHJlY3QgeD0iMTcwIiB5PSIwIiB3aWR0aD0iMjEwIiBoZWlnaHQ9IjIwIiBmaWxsPSJub25lIiBzdHJva2U9Im5vbmUiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiIHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogMjA4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogMTBweDsgbWFyZ2luLWxlZnQ6IDE3MXB4OyI+PGRpdiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwOyB0ZXh0LWFsaWduOiBjZW50ZXI7ICI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiAjMDAwMDAwOyBsaW5lLWhlaWdodDogMS4yOyBwb2ludGVyLWV2ZW50czogYWxsOyBmb250LXdlaWdodDogYm9sZDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgd29yZC13cmFwOiBub3JtYWw7ICI+U2FuZGJveDwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIyNzUiIHk9IjE0IiBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtd2VpZ2h0PSJib2xkIj5TYW5kYm94PC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIxODAiIHk9IjMwIiB3aWR0aD0iMTkwIiBoZWlnaHQ9IjMwIiBmaWxsPSIjZmZmMmNjIiBzdHJva2U9IiNkNmI2NTYiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiIHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogMTg4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogNDVweDsgbWFyZ2luLWxlZnQ6IDE4MXB4OyI+PGRpdiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwOyB0ZXh0LWFsaWduOiBjZW50ZXI7ICI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiAjMDAwMDAwOyBsaW5lLWhlaWdodDogMS4yOyBwb2ludGVyLWV2ZW50czogYWxsOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyB3b3JkLXdyYXA6IG5vcm1hbDsgIj5SdW50aW1lIExvYWRlcjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIyNzUiIHk9IjQ5IiBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPlJ1bnRpbWUgTG9hZGVyPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIxODAiIHk9IjgwIiB3aWR0aD0iMTkwIiBoZWlnaHQ9IjcwIiBmaWxsPSIjZTFkNWU3IiBzdHJva2U9IiM5NjczYTYiIHN0cm9rZS1kYXNoYXJyYXk9IjMgMyIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxyZWN0IHg9IjE4MCIgeT0iNjAiIHdpZHRoPSIxOTAiIGhlaWdodD0iMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0ibm9uZSIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjUgLTAuNSkiPjxzd2l0Y2g+PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OiB2aXNpYmxlOyB0ZXh0LWFsaWduOiBsZWZ0OyIgcG9pbnRlci1ldmVudHM9Im5vbmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiB1bnNhZmUgY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IHVuc2FmZSBjZW50ZXI7IHdpZHRoOiAxODhweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiA3MHB4OyBtYXJnaW4tbGVmdDogMTgxcHg7Ij48ZGl2IHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDA7IHRleHQtYWxpZ246IGNlbnRlcjsgIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6ICMwMDAwMDA7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IGZvbnQtd2VpZ2h0OiBib2xkOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyB3b3JkLXdyYXA6IG5vcm1hbDsgIj5JbnRlbCBTR1ggRW5jbGF2ZTwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIyNzUiIHk9Ijc0IiBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtd2VpZ2h0PSJib2xkIj5JbnRlbCBTR1ggRW5jbGF2ZTwvdGV4dD48L3N3aXRjaD48L2c+PHJlY3QgeD0iMTkwIiB5PSI5MCIgd2lkdGg9IjE3MCIgaGVpZ2h0PSI1MCIgZmlsbD0iI2RhZThmYyIgc3Ryb2tlPSIjNmM4ZWJmIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDE2OHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDExNXB4OyBtYXJnaW4tbGVmdDogMTkxcHg7Ij48ZGl2IHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDA7IHRleHQtYWxpZ246IGNlbnRlcjsgIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6ICMwMDAwMDA7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IHdvcmQtd3JhcDogbm9ybWFsOyAiPlJ1bnRpbWUgQmluYXJ5PC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjI3NSIgeT0iMTE5IiBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPlJ1bnRpbWUgQmluYXJ5PC90ZXh0Pjwvc3dpdGNoPjwvZz48cGF0aCBkPSJNIDEyNi4zNyAxMTUgTCAxODMuNjMgMTE1IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9InN0cm9rZSIvPjxwYXRoIGQ9Ik0gMTIxLjEyIDExNSBMIDEyOC4xMiAxMTEuNSBMIDEyNi4zNyAxMTUgTCAxMjguMTIgMTE4LjUgWiIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cGF0aCBkPSJNIDE4OC44OCAxMTUgTCAxODEuODggMTE4LjUgTCAxODMuNjMgMTE1IEwgMTgxLjg4IDExMS41IFoiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PC9nPjxzd2l0Y2g+PGcgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ii8+PGEgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwtNSkiIHhsaW5rOmhyZWY9Imh0dHBzOi8vZGVzay5kcmF3LmlvL3N1cHBvcnQvc29sdXRpb25zL2FydGljbGVzLzE2MDAwMDQyNDg3IiB0YXJnZXQ9Il9ibGFuayI+PHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMHB4IiB4PSI1MCUiIHk9IjEwMCUiPlZpZXdlciBkb2VzIG5vdCBzdXBwb3J0IGZ1bGwgU1ZHIDEuMTwvdGV4dD48L2E+PC9zd2l0Y2g+PC9zdmc+" width="381" height="161" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="framing">Framing<a class="hash-link" href="#framing" title="Direct link to heading">​</a></h2><p>All RHP messages use simple length-value framing with the value being encoded
using <a href="/core/encoding">canonical CBOR</a>. The frames are serialized on the wire as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[4-byte message length (big endian)] [CBOR-serialized message]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Maximum allowed message size is 16 MiB.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="messages">Messages<a class="hash-link" href="#messages" title="Direct link to heading">​</a></h2><p>Each <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Message" target="_blank" rel="noopener noreferrer">message</a> can be either a request or a response as specified by the type
field. Each request is assigned a unique 64-bit sequence number by the caller to
make it possible to correlate responses.</p><p>See the API reference (<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Body" target="_blank" rel="noopener noreferrer">Go</a>, <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime/src/types.rs" target="_blank" rel="noopener noreferrer">Rust</a>) for a list of all supported message bodies.
In case the request resulted in an error, the special <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Error" target="_blank" rel="noopener noreferrer"><code>Error</code></a> response body
must be used.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="operation">Operation<a class="hash-link" href="#operation" title="Direct link to heading">​</a></h2><p>RHP allows two forms of communication:</p><ul><li><p><strong>Host-to-runtime</strong> where the host (compute node) submits requests to the
runtime to handle and the runtime provides responses. All such request
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Body" target="_blank" rel="noopener noreferrer">messages</a> are prefixed with <code>Runtime</code>.</p></li><li><p><strong>Runtime-to-host</strong> where the runtime submits requests to the host and the
host provides responses. All such request <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Body" target="_blank" rel="noopener noreferrer">messages</a> are prefixed with
<code>Host</code>.</p></li></ul><p>In its lifetime, from connection establishment to its termination, the RHP
connection goes through the following states:</p><ul><li><p><em>Uninitialized</em> is the default state of a newly created connection. In this
state the connection could be used either on the runtime side or the host
side. To proceed to the next state, the connection must be initialized either
as a runtime or as a host. The <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime" target="_blank" rel="noopener noreferrer">Rust implementation</a> only supports runtime
mode while the <a href="https://github.com/oasisprotocol/oasis-core/tree/master/go/runtime/host/protocol" target="_blank" rel="noopener noreferrer">Go implementation</a> can be initialized in either mode by using
either <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Connection" target="_blank" rel="noopener noreferrer"><code>InitHost</code> or <code>InitGuest</code></a>.</p></li><li><p><em>Initializing</em> is the state when the connection is being initialized (see
below for details). After a connection has been successfully initialized it
will transition into <em>ready</em> state. If the initialization failed, it will
instead transition into <em>closed</em> state.</p></li><li><p><em>Ready</em> is the state when the connection can be used to exchange messages in
either direction.</p></li><li><p><em>Closed</em> is the state of the connection after it is considered closed. No
messages may be exchanged at this point.</p></li></ul><p>If either the runtime or the host generates an invalid message, either end may
terminate the connection (and/or the runtime process).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="initialization">Initialization<a class="hash-link" href="#initialization" title="Direct link to heading">​</a></h3><p>Before a connection can be used, it must be initialized as either representing
the runtime end or the host (compute node) end. The <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime" target="_blank" rel="noopener noreferrer">Rust implementation</a> only
supports being initialized as the runtime and the <a href="https://github.com/oasisprotocol/oasis-core/tree/master/go/runtime/host/protocol" target="_blank" rel="noopener noreferrer">Go implementation</a> is
currently only used as the host. If one uses the <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime" target="_blank" rel="noopener noreferrer"><code>oasis-core-runtime</code> crate</a>
to build a runtime, initialization is handled automatically.</p><p>The initialization procedure is driven by the host and it proceeds as follows:</p><ul><li><p>The host sends <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeInfoRequest" target="_blank" rel="noopener noreferrer"><code>RuntimeInfoRequest</code></a> providing the runtime with its
<a href="/core/runtime/identifiers">designated identifier</a>. The identifier comes from the <a href="/core/consensus/services/registry#runtimes">registry service</a> in
the consensus layer.</p></li><li><p>The runtime must reply with a <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeInfoResponse" target="_blank" rel="noopener noreferrer"><code>RuntimeInfoResponse</code></a> specifying its own
version and the version of the runtime host protocol that it supports. If the
protocol version is incompatible, initialization fails.</p></li></ul><p>After the initialization procedure, the connection can be used for other
messages. In case the runtime is running in a trusted execution environment
(TEE) like Intel SGX, the next required step is to perform remote attestation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="remote-attestation">Remote Attestation<a class="hash-link" href="#remote-attestation" title="Direct link to heading">​</a></h3><p>When a runtime is executed in a TEE, it must perform remote attestation
immediately after initialization. The <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime" target="_blank" rel="noopener noreferrer">Rust implementation</a> also requires that
remote attestation is periodically renewed and will start rejecting requests
otherwise. In case a runtime is not executed in a TEE, this step is skipped.</p><p><em>NOTE: As currently Intel SGX is the only supported TEE, the elements of the
remote attestation protocol are in some parts very specific to Intel SGX. This
may change in the future when support for additional TEEs is added.</em></p><p>Upon initialization the host performs the following steps:</p><ul><li><p><em>[Intel SGX]</em> The host obtains information for the runtime to be able to
generate an attestation report. This includes talking to the AESM service and
the IAS configuration. The information includes the identity of the Quoting
Enclave.</p></li><li><p>The host sends <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCapabilityTEERakInitRequest" target="_blank" rel="noopener noreferrer"><code>RuntimeCapabilityTEERakInitRequest</code></a> passing the information
required for the runtime to initialize its own ephemeral Runtime Attestation
Key (RAK). The RAK is valid for as long as the runtime is running.</p></li></ul><p>The initialization then proceeds as follows, with the following steps also
being performed as part of periodic re-attestation:</p><ul><li><p>The host sends <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCapabilityTEERakReportRequest" target="_blank" rel="noopener noreferrer"><code>RuntimeCapabilityTEERakReportRequest</code></a> requesting the runtime
to generate an attestation report.</p></li><li><p>The runtime prepares an attestation report based on the information provided
during the first initialization step. It responds with
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCapabilityTEERakReportResponse" target="_blank" rel="noopener noreferrer"><code>RuntimeCapabilityTEERakReportResponse</code></a> containing the public part of the
RAK, the attestation report (binding RAK to the TEE identity) and a replay
protection nonce.</p></li><li><p><em>[Intel SGX]</em> The host proceeds to submit the attestation report to the
Quoting Enclave to receive a quote. It submits the received quote to the
Intel Attestation Service (IAS) to receive a signed Attestation Verification
Report (AVR). It submits the AVR to the runtime by sending a
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCapabilityTEERakAvrRequest" target="_blank" rel="noopener noreferrer"><code>RuntimeCapabilityTEERakAvrRequest</code></a>.</p></li><li><p><em>[Intel SGX]</em> The runtime verifies the validity of the AVR, making sure that
it is not a replay and that it in fact contains the correct enclave identity
and the RAK binding.</p></li><li><p>Upon successful verification the runtime is now ready to accept requests. As
mentioned the attestation procedure must be performed periodically by the host
as otherwise the runtime may start rejecting requests.</p></li></ul><p>The compute node will submit remote attestation information to the consensus
<a href="/core/consensus/services/registry#runtimes">registry service</a> as part of its <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/common/node?tab=doc#Node" target="_blank" rel="noopener noreferrer">node registration descriptor</a>. The registry
service will verify that the submitted AVR is in fact valid and corresponds to
the registered runtime enclave identity. It will reject node registrations
otherwise.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="host-to-runtime">Host-to-runtime<a class="hash-link" href="#host-to-runtime" title="Direct link to heading">​</a></h3><p>The following section describes the calls that a host can make to request
processing from the runtime after successfully performing initialization (and
initial remote attestation if running in a TEE).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="transaction-batch-dispatch">Transaction Batch Dispatch<a class="hash-link" href="#transaction-batch-dispatch" title="Direct link to heading">​</a></h4><p>When a compute node needs to verify whether individual transactions are valid
it can optionally request the runtime to perform a simplified transaction check.
It can do this by sending a <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCheckTxBatchRequest" target="_blank" rel="noopener noreferrer"><code>RuntimeCheckTxBatchRequest</code></a> message. The runtime
should perform the required non-expensive checks, but should not fully execute
the transactions.</p><p>When a compute node receives a batch of transactions to process from the
transaction scheduler executor, it passes the batch to the runtime via the
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeExecuteTxBatchRequest" target="_blank" rel="noopener noreferrer"><code>RuntimeExecuteTxBatchRequest</code></a> message. The runtime must execute the
transactions in the given batch and produce a set of state changes (storage
updates for the output and state roots). In case the runtime is running in a TEE
the execution results must be signed by the Runtime Attestation Key (see above).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enclaverpc">EnclaveRPC<a class="hash-link" href="#enclaverpc" title="Direct link to heading">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-manager-policy-update">Key Manager Policy Update<a class="hash-link" href="#key-manager-policy-update" title="Direct link to heading">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="abort">Abort<a class="hash-link" href="#abort" title="Direct link to heading">​</a></h4><p>The host can request the runtime to abort processing the current batch by
sending the <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeAbortRequest" target="_blank" rel="noopener noreferrer"><code>RuntimeAbortRequest</code></a> message. The request does not take any
arguments. In case the response does not indicate an error the abort is deemed
successful by the host.</p><p>In case the runtime does not reply quickly enough the host may terminate the
runtime and start a new instance.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="extensions">Extensions<a class="hash-link" href="#extensions" title="Direct link to heading">​</a></h4><p>RHP provides a way for runtimes to support custom protocol extensions by
utilizing the <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeLocalRPCCallRequest" target="_blank" rel="noopener noreferrer"><code>RuntimeLocalRPCCallRequest</code></a> and <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeLocalRPCCallResponse" target="_blank" rel="noopener noreferrer"><code>RuntimeLocalRPCCallResponse</code></a>
messages.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="runtime-to-host">Runtime-to-host<a class="hash-link" href="#runtime-to-host" title="Direct link to heading">​</a></h3><p>The following section describes the calls that a runtime can make to request
processing from the host (or the wider distributed network on host&#x27;s behalf).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enclaverpc-to-remote-endpoints">EnclaveRPC to Remote Endpoints<a class="hash-link" href="#enclaverpc-to-remote-endpoints" title="Direct link to heading">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="read-only-runtime-storage-access">Read-only Runtime Storage Access<a class="hash-link" href="#read-only-runtime-storage-access" title="Direct link to heading">​</a></h4><p>The host exposes the <a href="/core/mkvs#read-syncer">MKVS read syncer</a> interface (via the
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#HostStorageSyncRequest" target="_blank" rel="noopener noreferrer"><code>HostStorageSyncRequest</code></a> message) to enable runtimes read-only access to
global runtime storage.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="untrusted-local-storage-access">Untrusted Local Storage Access<a class="hash-link" href="#untrusted-local-storage-access" title="Direct link to heading">​</a></h4><p>The host exposes a simple key-value local store that can be used by the runtime
to store arbitrary instance-specific data. <strong>Note that if the runtime is running
in a TEE this store must be treated as UNTRUSTED as the host may perform
arbitrary attacks. The runtime should use TEE-specific sealing to ensure
integrity and confidentiality of any stored data.</strong></p><p>There are two local storage operations, namely get and set, exposed via
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#HostLocalStorageGetRequest" target="_blank" rel="noopener noreferrer"><code>HostLocalStorageGetRequest</code></a> and <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#HostLocalStorageSetRequest" target="_blank" rel="noopener noreferrer"><code>HostLocalStorageSetRequest</code></a> messages,
respectively.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/oasisprotocol/oasis-core/edit/stable/22.2.x/docs/runtime/runtime-host-protocol.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-11-25T23:25:50.000Z">Nov 25, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/core/runtime/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Runtime Layer</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/core/runtime/identifiers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Runtime IDs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#transport" class="table-of-contents__link toc-highlight">Transport</a></li><li><a href="#framing" class="table-of-contents__link toc-highlight">Framing</a></li><li><a href="#messages" class="table-of-contents__link toc-highlight">Messages</a></li><li><a href="#operation" class="table-of-contents__link toc-highlight">Operation</a><ul><li><a href="#initialization" class="table-of-contents__link toc-highlight">Initialization</a></li><li><a href="#remote-attestation" class="table-of-contents__link toc-highlight">Remote Attestation</a></li><li><a href="#host-to-runtime" class="table-of-contents__link toc-highlight">Host-to-runtime</a></li><li><a href="#runtime-to-host" class="table-of-contents__link toc-highlight">Runtime-to-host</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/pJdWeVtmHT" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Watch us</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/channel/UC35UFPcZ2F1wjPxhPrSsESQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Oasis Protocol Foundation. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.df39c847.js"></script>
<script src="/assets/js/main.4ff8f277.js"></script>
</body>
</html>